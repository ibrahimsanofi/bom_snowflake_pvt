
/* ===========================================
   SHARED COLOR VARIABLES - Template 1 Theme
   =========================================== */
:root {
    /* Primary blue palette from Template 1 */
    --primary-bg-light: #e6f3ff;
    --primary-bg-medium: #cce7ff;
    --primary-border: #66b3ff;
    --primary-text: #0066cc;
    --primary-text-dark: #004499;
    
    /* Secondary gray palette */
    --secondary-bg-light: #f1f5f9;
    --secondary-bg-medium: #e2e8f0;
    --secondary-border: #cbd5e1;
    --secondary-text: #334155;
    --secondary-text-dark: #1e293b;
    
    /* Neutral colors */
    --white: #ffffff;
    --border-light: #e5e7eb;
    --border-medium: #6c757d;
    --text-muted: #6c757d;
    
    /* Value cell colors using blue theme */
    --value-bg-zero: #ffffff;
    --value-bg-positive: #f0f8ff;
    --value-bg-positive-border: #cce7ff;
    --value-text-positive: #0066cc;
    --value-bg-negative: #fef2f2;
    --value-border-negative: #fee2e2;
    --value-text-negative: #dc2626;
    --value-bg-large: #e6f3ff;
    --value-text-large: #004499;
    
    /* Root node styling using blue theme */
    --root-bg-light: #e6f3ff;
    --root-bg-medium: #cce7ff;
    --root-border: #66b3ff;
    --root-text: #0066cc;
    --root-text-dark: #004499;
}

/* ===========================================
   TEMPLATE 1: 1 row + 0 column + values
   =========================================== */
.template1 .t1-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
}

.template1 .t1-value-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
}

.template1 .t1-hierarchy-cell {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: var(--white) !important;
    border-right: 2px solid var(--primary-border) !important;
    min-width: 200px !important;
    max-width: 400px !important;
}

.template1 .leaf-node-empty {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 2px !important;
    background: var(--white) !important;
    vertical-align: middle !important;
}

/* ===========================================
   TEMPLATE 2: 2+ rows + 0 column + values
   =========================================== */

/* Container and table layout */
.template2 {
    width: 100% !important;
    overflow-x: auto !important;
}

.template2 table {
    width: 100% !important;
    table-layout: fixed !important;
    border-collapse: collapse !important;
    border-spacing: 0 !important;
}

/* Dynamic width calculation for row dimensions */
.template2.row-dimensions-1 .t2-row-header,
.template2.row-dimensions-1 .t2-dimension-cell {
    width: 50% !important;
    min-width: 50% !important;
    max-width: 50% !important;
}

.template2.row-dimensions-2 .t2-row-header,
.template2.row-dimensions-2 .t2-dimension-cell {
    width: 25% !important;
    min-width: 25% !important;
    max-width: 25% !important;
}

.template2.row-dimensions-3 .t2-row-header,
.template2.row-dimensions-3 .t2-dimension-cell {
    width: 16.666% !important;
    min-width: 16.666% !important;
    max-width: 16.666% !important;
}

.template2.row-dimensions-4 .t2-row-header,
.template2.row-dimensions-4 .t2-dimension-cell {
    width: 12.5% !important;
    min-width: 12.5% !important;
    max-width: 12.5% !important;
}

.template2.row-dimensions-5 .t2-row-header,
.template2.row-dimensions-5 .t2-dimension-cell {
    width: 10% !important;
    min-width: 10% !important;
    max-width: 10% !important;
}

/* Dynamic width calculation for value fields */
.template2.value-fields-1 .t2-value-header,
.template2.value-fields-1 .value-cell {
    width: 50% !important;
    min-width: 50% !important;
    max-width: 50% !important;
}

.template2.value-fields-2 .t2-value-header,
.template2.value-fields-2 .value-cell {
    width: 25% !important;
    min-width: 25% !important;
    max-width: 25% !important;
}

.template2.value-fields-3 .t2-value-header,
.template2.value-fields-3 .t2-dimension-cell {
    width: 16.666% !important;
    min-width: 16.666% !important;
    max-width: 16.666% !important;
}

.template2.value-fields-4 .t2-value-header,
.template2.value-fields-4 .value-cell {
    width: 12.5% !important;
    min-width: 12.5% !important;
    max-width: 12.5% !important;
}

.template2.value-fields-5 .t2-value-header,
.template2.value-fields-5 .value-cell {
    width: 10% !important;
    min-width: 10% !important;
    max-width: 10% !important;
}

/* Header styling using Template 1 colors */
.template2 .t2-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

.template2 .t2-value-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

/* Body cell styling */
.template2 .t2-dimension-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: top !important;
    hyphens: auto !important;
}

.template2 .value-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
}

/* Sticky positioning */
.template2 thead th {
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important;
    background-clip: padding-box !important;
}

.template2 .t2-dimension-cell:first-child {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: var(--white) !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template2 .t2-row-header:first-child {
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 50 !important;
    border-right: 2px solid var(--primary-border) !important;
}

/* Visual hierarchy */
.template2 [data-level="0"] {
    padding-left: 8px !important;
    font-weight: 700 !important;
    background-color: var(--primary-bg-light) !important;
}

.template2 [data-level="1"] {
    padding-left: 20px !important;
    font-weight: 600 !important;
}

.template2 [data-level="2"] {
    padding-left: 32px !important;
    font-weight: 500 !important;
}

.template2 [data-level="3"] {
    padding-left: 44px !important;
    font-weight: 400 !important;
}

.template2 [data-level="4"] {
    padding-left: 56px !important;
    font-weight: 400 !important;
    font-size: 0.9rem !important;
}

.template2 [data-level="5"], 
.template2 [data-level="6"],
.template2 [data-level="7"] {
    padding-left: 68px !important;
    font-weight: 400 !important;
    font-size: 0.85rem !important;
}

/* Hover effects */
.template2 tr:hover {
    background-color: rgba(102, 179, 255, 0.05) !important;
}

.template2 tr:hover .t2-dimension-cell {
    background-color: rgba(102, 179, 255, 0.08) !important;
}

.template2 tr:hover .dimension-label {
    color: var(--primary-text-dark) !important;
}

/* ===========================================
   TEMPLATE 3: 1 row + 1 column + values
   =========================================== */
.template3 .t3-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    min-width: 200px !important;
}

.template3 .t3-measures-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 2px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
}

.template3 .t3-measure-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
}

.template3 .t3-column-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    vertical-align: middle !important;
    min-width: 100px !important;
}

.template3 .t3-hierarchy-cell {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: var(--white) !important;
    border-right: 2px solid var(--primary-border) !important;
    min-width: 200px !important;
}

/* Root node styling for Template 3 */
.template3 .t3-column-header.root-node {
    background: linear-gradient(135deg, var(--primary-bg-medium) 0%, var(--primary-border) 100%) !important;
    border: 3px solid var(--primary-text) !important;
    color: var(--primary-text-dark) !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    position: relative !important;
    padding: 8px 12px !important;
    min-width: 120px !important;
}

.template3 .t3-column-header.root-node .column-label.root-label {
    font-weight: 800 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    display: inline-block !important;
    vertical-align: middle !important;
    /* border: 1px solid var(--primary-border) !important; */
}

.template3 .root-value-cell {
    font-weight: 700 !important;
    color: var(--primary-text-dark) !important;
    position: relative !important;
}

.template3 .root-value-cell.non-zero-value {
    color: var(--primary-text-dark) !important;
}

/* Visual separator between root and child columns */
.template3 .t3-column-header.root-node + .t3-column-header:not(.root-node) {
    border-left: 3px solid var(--primary-text) !important;
}

.template3 .root-value-cell + .value-cell:not(.root-value-cell) {
    /* border-left: 3px solid var(--primary-text) !important; */
}


/* ===========================================
   TEMPLATE 4: 2+ rows + 1 column + values
   Complete CSS - Build on Template 3 Foundation
   =========================================== */

/* Container styling - inherits Template 3's simplicity */
.template4 {
    width: 100% !important;
    height: auto !important;
    max-height: 60vh !important;
    min-height: 250px !important;
    overflow: auto !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
    position: relative !important;
}

.template4 .pivot-table-container {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    background: var(--white) !important;
    /* Ensure the container respects the width constraints */
    min-width: 800px !important; /* Minimum width for usability */
}

.template4 table {
    width: 100% !important;
    table-layout: fixed !important; /* CRITICAL: Fixed layout for percentage widths */
    border-collapse: separate !important;
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    min-width: fit-content !important;
}

/* ===========================================
   ROW DIMENSION HEADERS (Multiple) - 33% TOTAL WIDTH
   =========================================== */

/* Dynamic width calculation with 33% minimum for row dimensions */
.template4.row-dimensions-2 .t4-row-header,
.template4.row-dimensions-2 .t4-dimension-cell {
    min-width: 16.5% !important;  /* 33% ÷ 2 dimensions */
    width: 16.5% !important;
    max-width: 16.5% !important;
}

.template4.row-dimensions-3 .t4-row-header,
.template4.row-dimensions-3 .t4-dimension-cell {
    min-width: 11% !important;    /* 33% ÷ 3 dimensions */
    width: 11% !important;
    max-width: 11% !important;
}

.template4.row-dimensions-4 .t4-row-header,
.template4.row-dimensions-4 .t4-dimension-cell {
    min-width: 8.25% !important;  /* 33% ÷ 4 dimensions */
    width: 8.25% !important;
    max-width: 8.25% !important;
}

.template4.row-dimensions-5 .t4-row-header,
.template4.row-dimensions-5 .t4-dimension-cell {
    min-width: 6.6% !important;   /* 33% ÷ 5 dimensions */
    width: 6.6% !important;
    max-width: 6.6% !important;
}

/* Row dimension headers - inherit Template 3's proven styling */
.template4 .t4-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 12px 8px !important;
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 60 !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
}

/* Sticky positioning with percentage-based left values for 2 dimensions */
.template4.row-dimensions-2 .t4-row-header:nth-child(1) {
    left: 0% !important;
    z-index: 65 !important;
}

.template4.row-dimensions-2 .t4-row-header:nth-child(2) {
    left: 16.5% !important;
    z-index: 64 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for 3 dimensions */
.template4.row-dimensions-3 .t4-row-header:nth-child(1) {
    left: 0% !important;
    z-index: 65 !important;
}

.template4.row-dimensions-3 .t4-row-header:nth-child(2) {
    left: 11% !important;
    z-index: 64 !important;
}

.template4.row-dimensions-3 .t4-row-header:nth-child(3) {
    left: 22% !important;
    z-index: 63 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for 4 dimensions */
.template4.row-dimensions-4 .t4-row-header:nth-child(1) {
    left: 0% !important;
    z-index: 65 !important;
}

.template4.row-dimensions-4 .t4-row-header:nth-child(2) {
    left: 8.25% !important;
    z-index: 64 !important;
}

.template4.row-dimensions-4 .t4-row-header:nth-child(3) {
    left: 16.5% !important;
    z-index: 63 !important;
}

.template4.row-dimensions-4 .t4-row-header:nth-child(4) {
    left: 24.75% !important;
    z-index: 62 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for 5 dimensions */
.template4.row-dimensions-5 .t4-row-header:nth-child(1) {
    left: 0% !important;
    z-index: 65 !important;
}

.template4.row-dimensions-5 .t4-row-header:nth-child(2) {
    left: 6.6% !important;
    z-index: 64 !important;
}

.template4.row-dimensions-5 .t4-row-header:nth-child(3) {
    left: 13.2% !important;
    z-index: 63 !important;
}

.template4.row-dimensions-5 .t4-row-header:nth-child(4) {
    left: 19.8% !important;
    z-index: 62 !important;
}

.template4.row-dimensions-5 .t4-row-header:nth-child(5) {
    left: 26.4% !important;
    z-index: 61 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* ===========================================
   MEASURES AREA (Template 3 Style) - 67% WIDTH
   =========================================== */

/* Measures header - inherit Template 3's styling */
.template4 .t4-measures-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 2px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 15px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    box-sizing: border-box !important;
    /* Measures area automatically gets remaining space after 33% for row dimensions */
    min-width: 80px !important; /* Minimum column width for readability */
}

/* Value field headers - inherit Template 3's styling */
.template4 .t4-measure-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 10px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 100px !important;
    box-sizing: border-box !important;
}

/* Column headers - inherit Template 3's styling including root node styling */
.template4 .t4-column-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    vertical-align: middle !important;
    min-width: 100px !important;
    padding: 8px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    box-sizing: border-box !important;
}

/* Root node styling for Template 4 - inherit Template 3's proven approach */
.template4 .t4-column-header.root-node {
    background: linear-gradient(135deg, var(--primary-bg-medium) 0%, var(--primary-border) 100%) !important;
    border: 3px solid var(--primary-text) !important;
    color: var(--primary-text-dark) !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    position: relative !important;
    padding: 8px 12px !important;
    min-width: 120px !important;
}

.template4 .t4-column-header.root-node .column-label.root-label {
    font-weight: 800 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    display: inline-block !important;
    vertical-align: middle !important;
}

/* ===========================================
   ROW DIMENSION CELLS (Multiple) - 33% TOTAL WIDTH
   =========================================== */

/* Row dimension cells - inherit Template 2's proven multi-dimension approach */
.template4 .t4-dimension-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: middle !important;
    position: sticky !important;
    top: auto !important;
    z-index: 20 !important;
}

/* Sticky positioning for dimension cells with 2 dimensions */
.template4.row-dimensions-2 .t4-dimension-cell.dimension-0 {
    left: 0% !important;
    z-index: 25 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-2 .t4-dimension-cell.dimension-1 {
    left: 16.5% !important;
    z-index: 24 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for dimension cells with 3 dimensions */
.template4.row-dimensions-3 .t4-dimension-cell.dimension-0 {
    left: 0% !important;
    z-index: 25 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-3 .t4-dimension-cell.dimension-1 {
    left: 11% !important;
    z-index: 24 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-3 .t4-dimension-cell.dimension-2 {
    left: 22% !important;
    z-index: 23 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for dimension cells with 4 dimensions */
.template4.row-dimensions-4 .t4-dimension-cell.dimension-0 {
    left: 0% !important;
    z-index: 25 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-4 .t4-dimension-cell.dimension-1 {
    left: 8.25% !important;
    z-index: 24 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-4 .t4-dimension-cell.dimension-2 {
    left: 16.5% !important;
    z-index: 23 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-4 .t4-dimension-cell.dimension-3 {
    left: 24.75% !important;
    z-index: 22 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Sticky positioning for dimension cells with 5 dimensions */
.template4.row-dimensions-5 .t4-dimension-cell.dimension-0 {
    left: 0% !important;
    z-index: 25 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-5 .t4-dimension-cell.dimension-1 {
    left: 6.6% !important;
    z-index: 24 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-5 .t4-dimension-cell.dimension-2 {
    left: 13.2% !important;
    z-index: 23 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-5 .t4-dimension-cell.dimension-3 {
    left: 19.8% !important;
    z-index: 22 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template4.row-dimensions-5 .t4-dimension-cell.dimension-4 {
    left: 26.4% !important;
    z-index: 21 !important;
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* ===========================================
   VALUE CELLS (Template 3 Style) - 67% WIDTH
   =========================================== */

/* Value cells - inherit Template 3's styling */
.template4 .t4-value-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    min-width: 80px !important;
    white-space: nowrap !important;
}

/* Root value cells - inherit Template 3's styling */
.template4 .root-value-cell {
    font-weight: 700 !important;
    color: var(--primary-text-dark) !important;
    position: relative !important;
}

.template4 .root-value-cell.non-zero-value {
    color: var(--primary-text-dark) !important;
}

/* ===========================================
   HIERARCHY CONTROLS (Template 2 Style)
   =========================================== */

/* Visual hierarchy levels in dimension cells */
.template4 [data-level="0"] {
    font-weight: 700 !important;
    background-color: var(--primary-bg-light) !important;
}

.template4 [data-level="1"] {
    font-weight: 600 !important;
    padding-left: 20px !important;
}

.template4 [data-level="2"] {
    font-weight: 500 !important;
    padding-left: 32px !important;
}

.template4 [data-level="3"] {
    font-weight: 400 !important;
    padding-left: 44px !important;
}

.template4 [data-level="4"] {
    font-weight: 400 !important;
    padding-left: 56px !important;
    font-size: 0.9rem !important;
}

/* Cell content wrapper for proper alignment */
.template4 .cell-content {
    display: flex !important;
    align-items: center !important;
    min-height: auto !important;
    padding: 2px 0 !important;
}

/* Visual indication of the 33% boundary */
.template4::before {
    content: '';
    position: absolute;
    top: 0;
    left: 33%;
    width: 2px;
    height: 100%;
    background: linear-gradient(to bottom, var(--primary-text) 0%, transparent 100%);
    opacity: 0.2;
    z-index: 5;
    pointer-events: none;
}

/* ===========================================
   HOVER EFFECTS
   =========================================== */

/* Hover effects - inherit Template 3's approach */
.template4 tr:hover {
    background-color: rgba(102, 179, 255, 0.05) !important;
}

.template4 tr:hover .t4-dimension-cell {
    background-color: rgba(102, 179, 255, 0.08) !important;
}

.template4 tr:hover .t4-value-cell {
    background-color: rgba(102, 179, 255, 0.03) !important;
}

.template4 tr:hover .dimension-label {
    color: var(--primary-text-dark) !important;
}

/* ===========================================
   SCROLLBAR STYLING
   =========================================== */

.template4::-webkit-scrollbar {
    width: 8px !important;
    height: 8px !important;
}

.template4::-webkit-scrollbar-track {
    background: var(--secondary-bg-light) !important;
    border-radius: 4px !important;
}

.template4::-webkit-scrollbar-thumb {
    background: var(--primary-border) !important;
    border-radius: 4px !important;
    border: 1px solid var(--secondary-bg-light) !important;
}

.template4::-webkit-scrollbar-thumb:hover {
    background: var(--primary-text) !important;
}

/* ===========================================
   RESPONSIVE DESIGN
   =========================================== */

/* Responsive: Maintain 33% minimum on smaller screens */
@media (max-width: 1200px) {
    /* Keep the same percentage-based approach but ensure minimum readability */
    .template4.row-dimensions-2 .t4-row-header,
    .template4.row-dimensions-2 .t4-dimension-cell {
        min-width: 16.5% !important;
        font-size: 0.85rem !important;
    }
    
    .template4.row-dimensions-3 .t4-row-header,
    .template4.row-dimensions-3 .t4-dimension-cell {
        min-width: 11% !important;
        font-size: 0.8rem !important;
    }
    
    .template4.row-dimensions-4 .t4-row-header,
    .template4.row-dimensions-4 .t4-dimension-cell {
        min-width: 8.25% !important;
        font-size: 0.75rem !important;
        padding: 6px 8px !important;
    }
    
    .template4.row-dimensions-5 .t4-row-header,
    .template4.row-dimensions-5 .t4-dimension-cell {
        min-width: 6.6% !important;
        font-size: 0.7rem !important;
        padding: 4px 6px !important;
    }
}

@media (max-width: 768px) {
    /* On very small screens, still maintain proportions but with smaller text */
    .template4 .pivot-table-container {
        min-width: 600px !important;
    }
    
    .template4 .t4-row-header,
    .template4 .t4-dimension-cell {
        font-size: 0.65rem !important;
        padding: 4px !important;
    }
    
    .template4 .t4-value-cell {
        min-width: 60px !important;
        font-size: 0.7rem !important;
        padding: 4px 8px !important;
    }
}


/* ===========================================
   TEMPLATE 5: 2+ rows + 2+ columns + values
   Build on Template 6 Foundation + 33% Row Width
   =========================================== */


/* Container styling - auto-width with 45vh height limit */
   
.template5 {
    width: auto !important; /* Auto-extend based on content */
    min-width: 800px !important; /* Increased minimum for better column spacing */
    max-width: none !important; /* Allow unlimited horizontal expansion */
    height: auto !important;
    max-height: 45vh !important; /* Never exceed 45% of screen height */
    min-height: 200px !important;
    overflow: auto !important; /* Scrollbars appear automatically when needed */
    border: 1px solid var(--border-light) !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
    position: relative !important;
    display: block !important;
}

.template5 .pivot-table-container {
    width: auto !important; /* Allow container to expand with content */
    height: 100% !important;
    overflow: visible !important; /* Let parent handle scrolling */
    background: var(--white) !important;
    min-width: fit-content !important; /* Ensure container fits all content */
}

.template5 table {
    width: auto !important; /* Auto-size table based on content */
    table-layout: auto !important; /* Auto layout for content-based sizing */
    border-collapse: separate !important;
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    min-width: fit-content !important; /* Ensure table always fits content */
}

/* ===========================================
   ROW DIMENSIONS - Auto-fit with minimum widths
   =========================================== */

/* Row dimension headers and cells - auto-size with generous minimums */
.template5 .t5-row-header,
.template5 .t5-dimension-cell {
    width: auto !important; /* Auto-size based on content */
    min-width: 150px !important; /* Generous minimum width */
    max-width: none !important; /* No maximum constraint */
}

/* Row dimension headers */
.template5 .t5-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 2px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 15px !important; /* Increased padding for better spacing */
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 60 !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: visible !important; /* Allow content to be fully visible */
    text-overflow: clip !important; /* Don't truncate text */
}

/* Simplified sticky positioning - auto-calculated based on content width */
.template5 .t5-row-header:nth-child(1) { 
    left: 0 !important; 
    z-index: 65 !important; 
}

.template5 .t5-row-header:nth-child(2) { 
    z-index: 64 !important;
}

.template5 .t5-row-header:nth-child(3) { 
    z-index: 63 !important;
}

.template5 .t5-row-header:nth-child(4) { 
    z-index: 62 !important;
}

.template5 .t5-row-header:nth-child(5) { 
    z-index: 61 !important;
}

/* Special border for the last row header */
.template5 .t5-row-header:last-of-type {
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* Row dimension cells */
.template5 .t5-dimension-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    padding: 8px 12px !important; /* Increased padding for better spacing */
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: middle !important;
    position: sticky !important;
    top: auto !important;
    z-index: 20 !important;
    overflow: visible !important; /* Allow content to be fully visible */
}

/* Simplified sticky positioning for dimension cells */
.template5 .t5-dimension-cell.dimension-0 { 
    left: 0 !important; 
    z-index: 25 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template5 .t5-dimension-cell.dimension-1 { 
    z-index: 24 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template5 .t5-dimension-cell.dimension-2 { 
    z-index: 23 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template5 .t5-dimension-cell.dimension-3 { 
    z-index: 22 !important;
    border-right: 2px solid var(--primary-border) !important;
}

.template5 .t5-dimension-cell.dimension-4 { 
    z-index: 21 !important;
    border-right: 2px solid var(--primary-border) !important;
}

/* Special border for the last dimension cell */
.template5 .t5-dimension-cell:last-of-type {
    border-right: 3px solid var(--primary-text) !important;
    box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1) !important;
}

/* ===========================================
   MEASURES AREA - Auto-fit columns
   =========================================== */

/* Measures header */
.template5 .t5-measures-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 2px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 15px !important; /* Increased padding */
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    box-sizing: border-box !important;
    min-width: 120px !important; /* Increased minimum width */
    width: auto !important; /* Auto-size based on content */
    white-space: nowrap !important;
    overflow: visible !important; /* Allow content to be fully visible */
    text-overflow: clip !important; /* Don't truncate text */
}

/* Value field headers */
.template5 .t5-measure-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 10px 12px !important; /* Increased padding */
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 100px !important; /* Increased minimum width */
    width: auto !important; /* Auto-size based on content */
    box-sizing: border-box !important;
    white-space: nowrap !important;
    overflow: visible !important; /* Allow content to be fully visible */
    text-overflow: clip !important; /* Don't truncate text */
}

/* Column headers (hierarchical) */
.template5 .t5-column-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    padding: 8px 12px !important; /* Increased padding */
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 90px !important; /* Increased minimum width */
    width: auto !important; /* Auto-size based on content */
    box-sizing: border-box !important;
    vertical-align: middle !important;
    white-space: nowrap !important;
    overflow: visible !important; /* Allow content to be fully visible */
    text-overflow: clip !important; /* Don't truncate text */
}

/* Different styling for different column dimension levels */
.template5 .t5-column-header.dimension-level-0 {
    background: linear-gradient(135deg, var(--primary-bg-medium) 0%, var(--primary-border) 100%) !important;
    border: 2px solid var(--primary-text) !important;
    color: var(--primary-text-dark) !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
    letter-spacing: 0.5px !important;
    padding: 10px 8px !important;
}

.template5 .t5-column-header.dimension-level-1 {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    font-size: 0.85rem !important;
    padding: 8px 6px !important;
}

.template5 .t5-column-header.dimension-level-2 {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    font-size: 0.8rem !important;
    padding: 6px 4px !important;
}

/* ===========================================
   VALUE CELLS - Auto-fit with right alignment
   =========================================== */

/* Value cells with right alignment for all numeric values */
.template5 .t5-value-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    text-align: right !important; /* RIGHT ALIGNED as requested */
    padding: 8px 15px !important; /* Increased padding for better spacing */
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    min-width: 90px !important; /* Increased minimum width */
    width: auto !important; /* Auto-size based on content */
    white-space: nowrap !important;
    overflow: visible !important; /* Allow content to be fully visible */
    text-overflow: clip !important; /* Don't truncate numbers */
}

/* Enhanced styling for non-zero values */
.template5 .t5-value-cell.non-zero-value {
    /* background: var(--value-bg-positive) !important; */
    color: var(--value-text-positive) !important;
    font-weight: 600 !important;
}

.template5 .t5-value-cell.large-value {
    /* background: var(--value-bg-large) !important; */
    color: var(--value-text-large) !important;
    font-weight: 700 !important;
}

/* Negative values styling */
.template5 .t5-value-cell.negative-value,
.template5 .t5-value-cell[data-raw-value^="-"] {
    color: var(--value-text-negative) !important;
    font-weight: 700 !important;
    /* background: var(--value-bg-negative) !important; */
}

/* ===========================================
   HIERARCHY CONTROLS
   =========================================== */

/* Visual hierarchy levels in dimension cells */
.template5 [data-level="0"] {
    font-weight: 700 !important;
    background-color: var(--primary-bg-light) !important;
    padding-left: 8px !important;
}

.template5 [data-level="1"] {
    font-weight: 600 !important;
    padding-left: 16px !important;
}

.template5 [data-level="2"] {
    font-weight: 500 !important;
    padding-left: 24px !important;
}

.template5 [data-level="3"] {
    font-weight: 400 !important;
    padding-left: 32px !important;
}

.template5 [data-level="4"] {
    font-weight: 400 !important;
    padding-left: 40px !important;
    font-size: 0.9rem !important;
}

.template5 [data-level="5"],
.template5 [data-level="6"],
.template5 [data-level="7"] {
    font-weight: 400 !important;
    padding-left: 48px !important;
    font-size: 0.85rem !important;
}

/* Expand/collapse controls */
.template5 .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 6px !important;
    vertical-align: middle !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 3px !important;
    background: var(--white) !important;
    cursor: pointer !important;
    font-size: 11px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    flex-shrink: 0 !important;
}

.template5 .expand-collapse.collapsed {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border-color: var(--primary-border) !important;
    color: var(--primary-text) !important;
}

.template5 .expand-collapse.collapsed::before {
    content: "+" !important;
}

.template5 .expand-collapse.expanded {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border-color: var(--secondary-border) !important;
    color: var(--secondary-text) !important;
}

.template5 .expand-collapse.expanded::before {
    content: "−" !important;
}

.template5 .expand-collapse:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
}

/* Leaf node styling */
.template5 .leaf-node-empty {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 6px !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 3px !important;
    background: var(--white) !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
}

/* ===========================================
   ENHANCED SCROLLBARS - Auto-display
   =========================================== */

.template5::-webkit-scrollbar {
    width: 12px !important;
    height: 12px !important;
}

.template5::-webkit-scrollbar-track {
    background: var(--secondary-bg-light) !important;
    border-radius: 6px !important;
    border: 1px solid var(--border-light) !important;
}

.template5::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--primary-border) 0%, var(--primary-text) 100%) !important;
    border-radius: 6px !important;
    border: 2px solid var(--secondary-bg-light) !important;
    min-height: 20px !important;
}

.template5::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, var(--primary-text) 0%, var(--primary-text-dark) 100%) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

.template5::-webkit-scrollbar-corner {
    background: var(--secondary-bg-light) !important;
    border: 1px solid var(--border-light) !important;
}

/* Firefox scrollbar support */
.template5 {
    scrollbar-width: auto !important;
    scrollbar-color: var(--primary-border) var(--secondary-bg-light) !important;
}

/* ===========================================
   HOVER EFFECTS
   =========================================== */

.template5 tr:hover {
    background-color: rgba(102, 179, 255, 0.05) !important;
}

.template5 tr:hover .t5-dimension-cell {
    background-color: rgba(102, 179, 255, 0.08) !important;
}

.template5 tr:hover .t5-value-cell {
    background-color: rgba(102, 179, 255, 0.03) !important;
}

.template5 tr:hover .dimension-label {
    color: var(--primary-text-dark) !important;
}

.template5 .t5-column-header:hover {
    background-color: rgba(102, 179, 255, 0.15) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
}

/* Remove the 40% boundary indicator since we're using auto-fit columns */
.template5::before {
    display: none !important;
}

/* ===========================================
   RESPONSIVE DESIGN
   =========================================== */

@media (max-width: 1200px) {
    .template5 {
        min-width: 600px !important; /* Reduced for smaller screens */
    }
    
    .template5 .t5-row-header,
    .template5 .t5-dimension-cell {
        min-width: 120px !important; /* Maintain readability */
        padding: 6px 10px !important;
        font-size: 0.8rem !important;
    }
    
    .template5 .t5-value-cell {
        min-width: 70px !important;
        padding: 6px 12px !important;
        font-size: 0.8rem !important;
    }
    
    .template5 .t5-column-header {
        min-width: 70px !important;
        padding: 6px 8px !important;
        font-size: 0.75rem !important;
    }
    
    .template5 .t5-measure-header,
    .template5 .t5-measures-header {
        min-width: 80px !important;
        padding: 8px 10px !important;
        font-size: 0.8rem !important;
    }
}

@media (max-width: 768px) {
    .template5 {
        max-height: 40vh !important;
        min-width: 500px !important; /* Further reduced for mobile */
    }
    
    .template5 .t5-row-header,
    .template5 .t5-dimension-cell {
        min-width: 100px !important;
        padding: 4px 8px !important;
        font-size: 0.7rem !important;
    }
    
    .template5 .t5-value-cell {
        min-width: 60px !important;
        padding: 4px 10px !important;
        font-size: 0.7rem !important;
    }
    
    .template5 .t5-column-header {
        min-width: 60px !important;
        padding: 4px 6px !important;
        font-size: 0.65rem !important;
    }
    
    .template5 .t5-measure-header,
    .template5 .t5-measures-header {
        min-width: 70px !important;
        padding: 6px 8px !important;
        font-size: 0.7rem !important;
    }
    
    .template5 .expand-collapse,
    .template5 .leaf-node-empty {
        width: 14px !important;
        height: 14px !important;
        margin-right: 4px !important;
    }
}

/* ===========================================
   ACCESSIBILITY
   =========================================== */

.template5 .expand-collapse:focus {
    outline: 2px solid var(--primary-text) !important;
    outline-offset: 2px !important;
}

.template5 .t5-column-header:focus-within {
    outline: 2px solid var(--primary-text) !important;
    outline-offset: 2px !important;
}

/* ===========================================
   PRINT STYLES
   =========================================== */

@media print {
    .template5 {
        max-height: none !important;
        overflow: visible !important;
        box-shadow: none !important;
        border: 1px solid #000 !important;
    }
    
    .template5 .expand-collapse,
    .template5 .leaf-node-empty {
        display: none !important;
    }
}


/* ===========================================
   TEMPLATE 6: 1 row + 2+ columns + values (Hierarchical)
   =========================================== */
.template6 {
    width: 100% !important;
    height: auto !important;
    max-height: 60vh !important;
    min-height: 250px !important;
    overflow: auto !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
}

.template6 .pivot-table-container {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    background: var(--white) !important;
}

.template6 table {
    width: 100% !important;
    table-layout: auto !important;
    border-collapse: separate !important;
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    min-width: fit-content !important;
}

/* Row dimension header (sticky left) */
.template6 .t6-row-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 2px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 15px 12px !important;
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 60 !important;
    min-width: 500px !important;
    max-width: 650px !important;
    width: 500px !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
}

/* Measures header */
.template6 .t6-measures-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 2px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 15px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    box-sizing: border-box !important;
}

/* Value field headers */
.template6 .t6-measure-header {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 10px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 100px !important;
    box-sizing: border-box !important;
}

/* Hierarchical column headers */
.template6 .t6-column-header {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    text-align: center !important;
    padding: 8px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 80px !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    white-space: nowrap !important;
}

/* Different styling for different dimension levels */
.template6 .t6-column-header.dimension-level-0 {
    background: linear-gradient(135deg, var(--primary-bg-medium) 0%, var(--primary-border) 100%) !important;
    border: 2px solid var(--primary-text) !important;
    color: var(--primary-text-dark) !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
    letter-spacing: 0.5px !important;
    padding: 10px 12px !important;
}

.template6 .t6-column-header.dimension-level-1 {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border: 1px solid var(--primary-border) !important;
    color: var(--primary-text) !important;
    font-weight: 600 !important;
    font-size: 0.85rem !important;
    padding: 8px 10px !important;
}

.template6 .t6-column-header.dimension-level-2 {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border: 1px solid var(--secondary-border) !important;
    color: var(--secondary-text) !important;
    font-weight: 600 !important;
    font-size: 0.8rem !important;
    padding: 6px 8px !important;
}

/* Row hierarchy cell (sticky left) */
.template6 .t6-hierarchy-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    border-right: 2px solid var(--primary-border) !important;
    padding: 8px 12px !important;
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    min-width: 180px !important;
    max-width: 250px !important;
    width: 200px !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
}

/* Value cells */
.template6 .t6-value-cell {
    background: var(--white) !important;
    border: 1px solid var(--border-light) !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    min-width: 80px !important;
    white-space: nowrap !important;
}

/* ===========================================
   UNIVERSAL STYLES FOR ALL TEMPLATES
   =========================================== */

/* Enhanced expand/collapse controls using blue theme */
[class*="template"] .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 18px !important;
    height: 18px !important;
    margin-right: 8px !important;
    vertical-align: middle !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 3px !important;
    background: var(--white) !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    flex-shrink: 0 !important;
}

[class*="template"] .expand-collapse.collapsed {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border-color: var(--primary-border) !important;
    color: var(--primary-text) !important;
}

[class*="template"] .expand-collapse.collapsed::before {
    content: "+" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 14px !important;
    font-weight: bold !important;
}

[class*="template"] .expand-collapse.expanded {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border-color: var(--secondary-border) !important;
    color: var(--secondary-text) !important;
}

[class*="template"] .expand-collapse.expanded::before {
    content: "−" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 16px !important;
    font-weight: bold !important;
}

[class*="template"] .expand-collapse:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
}

/* Leaf node styling */
[class*="template"] .leaf-node-empty {
    display: inline-block !important;
    width: 18px !important;
    height: 18px !important;
    margin-right: 8px !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 3px !important;
    background: var(--white) !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
    box-sizing: border-box !important;
}

/* Dimension labels */
[class*="template"] .dimension-label {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: clip !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.3 !important;
    max-width: calc(100% - 30px) !important;
}

[class*="template"] .column-label {
    display: inline-block !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    font-weight: inherit !important;
    color: inherit !important;
    max-width: none !important;
}

/* Value cells consistent across all templates */
[class*="template"] .value-cell {
    text-align: right !important;
    font-family: var(--font-sans, system-ui) !important;
    background-color: var(--value-bg-zero) !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    transition: background-color 0.2s ease !important;
    min-width: fit-content !important;
    width: auto !important;
    border: 1px solid var(--border-light) !important;
}

/* Enhanced value cell styling for non-zero values using blue theme */
[class*="template"] .value-cell.non-zero-value {
    /* background: var(--value-bg-positive) !important; */
    color: var(--value-text-positive) !important;
    font-weight: 600 !important;
}

[class*="template"] .value-cell.large-value {
    /* background: var(--value-bg-large) !important; */
    color: var(--value-text-large) !important;
    font-weight: 700 !important;
}

/* Negative values styling */
[class*="template"] .value-cell[data-raw-value^="-"] {
    color: var(--value-text-negative) !important;
    font-weight: 700 !important;
    /* background: var(--value-bg-negative) !important; */
}

[class*="template"] .value-cell.negative-value {
    color: var(--value-text-negative) !important;
    font-weight: 700 !important;
    /* background: var(--value-bg-negative) !important; */
}

/* ===========================================
   ROOT NODE STYLING - UNIFIED BLUE THEME
   =========================================== */

/* Root node headers in all templates */
[class*="template"] .column-header.root-node,
[class*="template"] [class*="-column-header"].root-node {
    background: linear-gradient(135deg, var(--root-bg-light) 0%, var(--root-bg-medium) 100%) !important;
    border: 2px solid var(--root-border) !important;
    color: var(--root-text-dark) !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 1.2px !important;
}

/* Root node labels */
[class*="template"] .column-label.root-label {
    font-weight: 800 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
}

/* Root node expand/collapse controls */
[class*="template"] .root-node .expand-collapse {
    background: linear-gradient(135deg, var(--root-text) 0%, var(--root-border) 100%) !important;
    border: 1px solid var(--root-text) !important;
    color: var(--white) !important;
    font-weight: bold !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

[class*="template"] .root-node .expand-collapse:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3) !important;
}

/* Template 3 specific root node enhancements */
.template3 .t3-column-header.root-node .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 20px !important;
    height: 20px !important;
    margin-right: 8px !important;
    vertical-align: middle !important;
    border: 2px solid var(--border-medium) !important;
    border-radius: 4px !important;
    background: var(--white) !important;
    cursor: pointer !important;
    font-size: 14px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    flex-shrink: 0 !important;
    pointer-events: auto !important;
    z-index: 10 !important;
    position: relative !important;
}

.template3 .t3-column-header.root-node .expand-collapse.collapsed {
    background: linear-gradient(135deg, var(--primary-bg-light) 0%, var(--primary-bg-medium) 100%) !important;
    border-color: var(--primary-border) !important;
    color: var(--primary-text) !important;
}

.template3 .t3-column-header.root-node .expand-collapse.expanded {
    background: linear-gradient(135deg, var(--secondary-bg-light) 0%, var(--secondary-bg-medium) 100%) !important;
    border-color: var(--secondary-border) !important;
    color: var(--secondary-text) !important;
}

/* Root value cells */
[class*="template"] .root-value-cell {
    font-weight: 600 !important;
    color: var(--root-text-dark) !important;
}

/* ===========================================
   HIERARCHY CONTROLS FOR ALL TEMPLATES
   =========================================== */
[class*="template"] .hierarchy-cell,
[class*="template"] [class*="hierarchy-cell"],
[class*="template"] [class*="dimension-cell"] {
    padding: 8px 12px !important;
    vertical-align: middle !important;
    border: 1px solid var(--border-light) !important;
}

/* Visual hierarchy levels */
[class*="template"] [data-level="0"] {
    font-weight: 700 !important;
    background-color: var(--primary-bg-light) !important;
}

[class*="template"] [data-level="1"] {
    font-weight: 600 !important;
    padding-left: 20px !important;
}

[class*="template"] [data-level="2"] {
    font-weight: 500 !important;
    padding-left: 32px !important;
}

[class*="template"] [data-level="3"] {
    font-weight: 400 !important;
    padding-left: 44px !important;
}

[class*="template"] [data-level="4"] {
    font-weight: 400 !important;
    padding-left: 56px !important;
    font-size: 0.9rem !important;
}

/* ===========================================
   HOVER EFFECTS - UNIFIED BLUE THEME
   =========================================== */
[class*="template"] tr:hover {
    background-color: rgba(102, 179, 255, 0.05) !important;
}

[class*="template"] tr:hover [class*="dimension-cell"],
[class*="template"] tr:hover [class*="hierarchy-cell"] {
    background-color: rgba(102, 179, 255, 0.08) !important;
}

[class*="template"] tr:hover .value-cell {
    background-color: rgba(102, 179, 255, 0.03) !important;
}

[class*="template"] [class*="column-header"]:hover {
    background-color: rgba(102, 179, 255, 0.15) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
}

/* ===========================================
   STICKY POSITIONING FOR ALL TEMPLATES
   =========================================== */
[class*="template"] thead th {
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important;
    background-clip: padding-box !important;
}

[class*="template"] [class*="hierarchy-cell"],
[class*="template"] [class*="dimension-cell"]:first-child {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: var(--white) !important;
}

[class*="template"] .corner-cell,
[class*="template"] [class*="row-header"][rowspan] {
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 50 !important;
    text-align: center !important;
    vertical-align: middle !important;
}

/* ===========================================
   RESPONSIVE DESIGN FOR ALL TEMPLATES
   =========================================== */
@media (max-width: 1200px) {
    [class*="template"] .leaf-node-empty,
    [class*="template"] .expand-collapse {
        width: 16px !important;
        height: 16px !important;
        margin-right: 6px !important;
        font-size: 10px !important;
    }
    
    [class*="template"] th,
    [class*="template"] td {
        padding: 6px 8px !important;
        font-size: 0.8rem !important;
    }
}

@media (max-width: 768px) {
    [class*="template"] .leaf-node-empty,
    [class*="template"] .expand-collapse {
        width: 14px !important;
        height: 14px !important;
        margin-right: 4px !important;
        font-size: 8px !important;
    }
    
    [class*="template"] th,
    [class*="template"] td {
        padding: 4px 6px !important;
        font-size: 0.75rem !important;
    }
}

/* ===========================================
   SCROLLBAR STYLING - UNIFIED THEME
   =========================================== */
[class*="template"]::-webkit-scrollbar {
    width: 8px !important;
    height: 8px !important;
}

[class*="template"]::-webkit-scrollbar-track {
    background: var(--secondary-bg-light) !important;
    border-radius: 4px !important;
}

[class*="template"]::-webkit-scrollbar-thumb {
    background: var(--primary-border) !important;
    border-radius: 4px !important;
    border: 1px solid var(--secondary-bg-light) !important;
}

[class*="template"]::-webkit-scrollbar-thumb:hover {
    background: var(--primary-text) !important;
}

[class*="template"]::-webkit-scrollbar-corner {
    background: var(--secondary-bg-light) !important;
}

/* ===========================================
   ACCESSIBILITY AND PRINT STYLES
   =========================================== */
[class*="template"] .expand-collapse:focus,
[class*="template"] [class*="column-header"]:focus-within {
    outline: 2px solid var(--primary-text) !important;
    outline-offset: 2px !important;
}

@media print {
    [class*="template"] {
        box-shadow: none !important;
        border: 1px solid #000 !important;
    }
    
    [class*="template"] .expand-collapse {
        display: none !important;
    }
    
    [class*="template"] .leaf-node-empty {
        display: none !important;
    }
}

@media (prefers-contrast: high) {
    [class*="template"] [class*="row-header"],
    [class*="template"] [class*="column-header"] {
        background: #000 !important;
        color: #fff !important;
        border: 2px solid #fff !important;
    }
    
    [class*="template"] .value-cell {
        background: #fff !important;
        color: #000 !important;
        border: 1px solid #000 !important;
    }
}