/* ===========================================
   PIVOT TABLE TEMPLATE-SPECIFIC CSS
   Separate styles for each template to avoid conflicts
   =========================================== */

/* ---------- TEMPLATE 1: 1 row + 0 column + values ---------- */
.template1 .t1-row-header {
    background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%) !important;
    border: 1px solid #66b3ff !important;
    color: #0066cc !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
}

.template1 .t1-value-header {
    background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
    border: 1px solid #cbd5e1 !important;
    color: #334155 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
}

.template1 .t1-hierarchy-cell {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: white !important;
    border-right: 2px solid #66b3ff !important;
    min-width: 200px !important;
    max-width: 400px !important;
}

.template1 .leaf-node-empty {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    vertical-align: middle !important;
}

/* ===========================================
   TEMPLATE 2 FULL WIDTH CSS - 50:50 SPLIT
   2+ rows + 0 column + values with optimal space usage
   =========================================== */

/* ---------- TEMPLATE 2 CONTAINER AND TABLE LAYOUT ---------- */
.template2 {
    width: 100% !important;
    overflow-x: auto !important;
}

.template2 table {
    width: 100% !important;
    table-layout: fixed !important; /* Fixed layout for precise width control */
    border-collapse: collapse !important;
    border-spacing: 0 !important;
}

/* ---------- DYNAMIC WIDTH CALCULATION FOR ROW DIMENSIONS ---------- */
/* Calculate equal width for each row dimension within 50% allocation */
.template2.row-dimensions-1 .t2-row-header,
.template2.row-dimensions-1 .t2-dimension-cell {
    width: 50% !important;
    min-width: 50% !important;
    max-width: 50% !important;
}

.template2.row-dimensions-2 .t2-row-header,
.template2.row-dimensions-2 .t2-dimension-cell {
    width: 25% !important; /* 50% / 2 dimensions */
    min-width: 25% !important;
    max-width: 25% !important;
}

.template2.row-dimensions-3 .t2-row-header,
.template2.row-dimensions-3 .t2-dimension-cell {
    width: 16.666% !important; /* 50% / 3 dimensions */
    min-width: 16.666% !important;
    max-width: 16.666% !important;
}

.template2.row-dimensions-4 .t2-row-header,
.template2.row-dimensions-4 .t2-dimension-cell {
    width: 12.5% !important; /* 50% / 4 dimensions */
    min-width: 12.5% !important;
    max-width: 12.5% !important;
}

.template2.row-dimensions-5 .t2-row-header,
.template2.row-dimensions-5 .t2-dimension-cell {
    width: 10% !important; /* 50% / 5 dimensions */
    min-width: 10% !important;
    max-width: 10% !important;
}

/* ---------- DYNAMIC WIDTH CALCULATION FOR VALUE FIELDS ---------- */
/* Calculate equal width for each value field within 50% allocation */
.template2.value-fields-1 .t2-value-header,
.template2.value-fields-1 .value-cell {
    width: 50% !important;
    min-width: 50% !important;
    max-width: 50% !important;
}

.template2.value-fields-2 .t2-value-header,
.template2.value-fields-2 .value-cell {
    width: 25% !important; /* 50% / 2 fields */
    min-width: 25% !important;
    max-width: 25% !important;
}

.template2.value-fields-3 .t2-value-header,
.template2.value-fields-3 .value-cell {
    width: 16.666% !important; /* 50% / 3 fields */
    min-width: 16.666% !important;
    max-width: 16.666% !important;
}

.template2.value-fields-4 .t2-value-header,
.template2.value-fields-4 .value-cell {
    width: 12.5% !important; /* 50% / 4 fields */
    min-width: 12.5% !important;
    max-width: 12.5% !important;
}

.template2.value-fields-5 .t2-value-header,
.template2.value-fields-5 .value-cell {
    width: 10% !important; /* 50% / 5 fields */
    min-width: 10% !important;
    max-width: 10% !important;
}

/* ---------- ENHANCED HEADER STYLING ---------- */
.template2 .t2-row-header {
    background: linear-gradient(135deg, #e6ffe6 0%, #ccffcc 100%) !important;
    border: 1px solid #66cc66 !important;
    color: #006600 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

.template2 .t2-value-header {
    background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
    border: 1px solid #cbd5e1 !important;
    color: #334155 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

/* ---------- BODY CELL STYLING ---------- */
.template2 .t2-dimension-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: top !important;
    hyphens: auto !important;
}

.template2 .value-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
}

/* ---------- STICKY POSITIONING ---------- */
.template2 thead th {
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important;
    background-clip: padding-box !important;
}

/* Make first column of each row sticky */
.template2 .t2-dimension-cell:first-child {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: white !important;
    border-right: 2px solid #66cc66 !important;
}

.template2 .t2-row-header:first-child {
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 50 !important;
    border-right: 2px solid #66cc66 !important;
}

/* ---------- RESPONSIVE ADJUSTMENTS ---------- */
@media (max-width: 1200px) {
    .template2 .t2-row-header,
    .template2 .t2-value-header {
        padding: 8px 6px !important;
        font-size: 0.8rem !important;
        letter-spacing: 0.5px !important;
    }
    
    .template2 .t2-dimension-cell,
    .template2 .value-cell {
        padding: 6px 8px !important;
        font-size: 0.8rem !important;
    }
}

@media (max-width: 768px) {
    .template2 .t2-row-header,
    .template2 .t2-value-header {
        padding: 6px 4px !important;
        font-size: 0.75rem !important;
        letter-spacing: 0px !important;
    }
    
    .template2 .t2-dimension-cell,
    .template2 .value-cell {
        padding: 4px 6px !important;
        font-size: 0.75rem !important;
    }
}

/* ---------- HIERARCHY STYLING WITH OPTIMAL SPACE USAGE ---------- */
.template2 .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    vertical-align: middle !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    cursor: pointer !important;
    font-size: 10px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    flex-shrink: 0 !important;
}

.template2 .leaf-node-empty {
    display: inline-block !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
}

.template2 .dimension-label {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: clip !important;
    max-width: calc(100% - 25px) !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.3 !important;
    hyphens: auto !important;
}

/* ---------- ENHANCED VISUAL HIERARCHY ---------- */
/* Level-based indentation optimized for fixed width */
.template2 [data-level="0"] {
    padding-left: 8px !important;
    font-weight: 700 !important;
    background-color: #f8fffe !important;
}

.template2 [data-level="1"] {
    padding-left: 20px !important;
    font-weight: 600 !important;
}

.template2 [data-level="2"] {
    padding-left: 32px !important;
    font-weight: 500 !important;
}

.template2 [data-level="3"] {
    padding-left: 44px !important;
    font-weight: 400 !important;
}

.template2 [data-level="4"] {
    padding-left: 56px !important;
    font-weight: 400 !important;
    font-size: 0.9rem !important;
}

/* For deeper levels, reduce indentation to fit in constrained width */
.template2 [data-level="5"], 
.template2 [data-level="6"],
.template2 [data-level="7"] {
    padding-left: 68px !important;
    font-weight: 400 !important;
    font-size: 0.85rem !important;
}

/* ---------- HOVER EFFECTS ---------- */
.template2 tr:hover {
    background-color: rgba(102, 204, 102, 0.05) !important;
}

.template2 tr:hover .t2-dimension-cell {
    background-color: rgba(102, 204, 102, 0.08) !important;
}

.template2 tr:hover .dimension-label {
    color: #004d00 !important;
}

/* ---------- ENHANCED VALUE CELL STYLING ---------- */
.template2 .value-cell.non-zero-value {
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffe6 100%) !important;
    color: #006600 !important;
    font-weight: 600 !important;
}

.template2 .value-cell.large-value {
    background: linear-gradient(135deg, #fff8dc 0%, #f0e68c 100%) !important;
    color: #b8860b !important;
    font-weight: 700 !important;
}

.template2 .value-cell[data-raw-value^="-"] {
    color: #dc2626 !important;
    font-weight: 700 !important;
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
}

/* ---------- CONTAINER OVERFLOW HANDLING ---------- */
.template2 .pivot-table-container {
    width: 100% !important;
    overflow-x: auto !important;
    overflow-y: auto !important;
    max-height: 70vh !important;
    border: 1px solid #e5e7eb !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
}

/* ---------- DEBUG HELPER (REMOVE IN PRODUCTION) ---------- */
.template2.debug .t2-row-header {
    background: rgba(255, 0, 0, 0.1) !important;
    border: 2px solid red !important;
}

.template2.debug .t2-value-header {
    background: rgba(0, 0, 255, 0.1) !important;
    border: 2px solid blue !important;
}

.template2.debug .t2-dimension-cell {
    background: rgba(255, 255, 0, 0.1) !important;
}

.template2.debug .value-cell {
    background: rgba(0, 255, 0, 0.1) !important;
}

/* ---------- TEMPLATE 3: 1 row + 1 column + values ---------- */
.template3 .t3-row-header {
    background: linear-gradient(135deg, #fff0e6 0%, #ffe0cc 100%) !important;
    border: 1px solid #ff9966 !important;
    color: #cc4400 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    min-width: 200px !important;
}

.template3 .t3-measures-header {
    background: linear-gradient(135deg, #f8f0ff 0%, #e6ccff 100%) !important;
    border: 2px solid #9966cc !important;
    color: #663399 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
}

.template3 .t3-measure-header {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe0b3 100%) !important;
    border: 1px solid #ff9933 !important;
    color: #cc6600 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
}

.template3 .t3-column-header {
    background: linear-gradient(135deg, #e6f7ff 0%, #ccf0ff 100%) !important;
    border: 1px solid #66ccff !important;
    color: #0099cc !important;
    font-weight: 600 !important;
    text-align: center !important;
    min-width: 100px !important;
}

.template3 .t3-hierarchy-cell {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: white !important;
    border-right: 2px solid #ff9966 !important;
    min-width: 200px !important;
}

/* ===========================================
   TEMPLATE 4 FULL WIDTH CSS - 45:55 SPLIT
   2+ rows + 1 column + values with cross-tabulation
   =========================================== */
/* ---------- CONTAINER SETUP FOR FROZEN PANES ---------- */
.template4 {
    width: 100% !important;
    height: auto !important; /* CHANGED: was 80vh */
    max-height: 40vh !important; /* ADDED: 40% screen height limit */
    min-height: 300px !important; /* ADDED: minimum usable height */
    position: relative !important;
    overflow: hidden !important;
}

.template4 .pivot-table-container {
    width: 100% !important;
    height: 100% !important;
    position: relative !important;
    overflow: hidden !important;
    border: 1px solid #e5e7eb !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
}

/* ---------- FROZEN ROW DIMENSIONS AREA (LEFT SIDE) ---------- */
.template4 .frozen-row-dimensions {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 45% !important;
    height: 100% !important;
    background: white !important;
    border-right: 1px solid #6c757d !important; /* CHANGED: consistent with separator */
    z-index: 100 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* ---------- SCROLLABLE VALUE AREA (RIGHT SIDE) ---------- */
.template4 .scrollable-value-area {
    position: absolute !important;
    top: 0 !important;
    left: 45% !important; /* Starts after row dimensions */
    width: 55% !important; /* Remaining 55% for values */
    height: 100% !important;
    overflow: auto !important; /* Both horizontal and vertical scroll */
    background: white !important;
}

/* ---------- TABLE LAYOUT FOR FROZEN PANES ---------- */
.template4 table {
    width: 100% !important;
    table-layout: fixed !important;
    border-collapse: separate !important; /* Separate for frozen effect */
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* ROW DIMENSIONS TABLE (FROZEN AREA) */
.template4 .frozen-row-dimensions table {
    width: 100% !important;
    table-layout: fixed !important;
}

/* VALUE AREA TABLE (SCROLLABLE AREA) */
.template4 .scrollable-value-area table {
    width: max-content !important; /* Expands based on content */
    table-layout: auto !important;
    min-width: 100% !important;
}

/* ---------- ROW DIMENSION STYLING (FROZEN) ---------- */
.template4.row-dimensions-2 .frozen-row-dimensions .t4-row-header,
.template4.row-dimensions-2 .frozen-row-dimensions .t4-dimension-cell {
    width: 50% !important; /* Split the 45% evenly */
    min-width: 50% !important;
    max-width: 50% !important;
}

.template4.row-dimensions-3 .frozen-row-dimensions .t4-row-header,
.template4.row-dimensions-3 .frozen-row-dimensions .t4-dimension-cell {
    width: 33.333% !important; /* Split the 45% evenly */
    min-width: 33.333% !important;
    max-width: 33.333% !important;
}

.template4.row-dimensions-4 .frozen-row-dimensions .t4-row-header,
.template4.row-dimensions-4 .frozen-row-dimensions .t4-dimension-cell {
    width: 25% !important; /* Split the 45% evenly */
    min-width: 25% !important;
    max-width: 25% !important;
}

/* ---------- VALUE AREA STYLING (SCROLLABLE) ---------- */
.template4 .scrollable-value-area .t4-measures-header,
.template4 .scrollable-value-area .t4-measure-header,
.template4 .scrollable-value-area .t4-column-header,
.template4 .scrollable-value-area .value-cell {
    width: auto !important;
    min-width: max-content !important;
    max-width: none !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
}

/* ---------- SYNCHRONIZED SCROLLING ---------- */
.template4 .frozen-row-dimensions {
    scrollbar-width: none !important; /* Hide horizontal scrollbar */
    -ms-overflow-style: none !important;
}

.template4 .frozen-row-dimensions::-webkit-scrollbar {
    display: none !important; /* Hide horizontal scrollbar */
    width: 6px !important; /* CHANGED: thinner scrollbar */
    background: transparent !important;
}

.template4 .frozen-row-dimensions::-webkit-scrollbar-track {
    background: #f8f9fa !important;
}

.template4 .frozen-row-dimensions::-webkit-scrollbar-thumb {
    background: #cbd5e1 !important;
    border-radius: 3px !important;
}

.template4 .cell-content {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: flex-start !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
}

.template4 .value-cell .cell-content {
    justify-content: flex-end !important; /* Right-align values */
}

/* ---------- HEADER STYLING FOR BOTH AREAS ---------- */
/* Frozen Row Dimension Headers */
.template4 .frozen-row-dimensions .t4-row-header {
    background: linear-gradient(135deg, #f0f8ff 0%, #ddeeff 100%) !important;
    border: 1px solid #6699ff !important;
    color: #003399 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 20 !important;
}

/* Scrollable Value Headers */
.template4 .scrollable-value-area .t4-measures-header {
    background: linear-gradient(135deg, #f8f0ff 0%, #e6ccff 100%) !important;
    border: 2px solid #9966cc !important;
    color: #663399 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
}

.template4 .scrollable-value-area .t4-measure-header {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe0b3 100%) !important;
    border: 1px solid #ff9933 !important;
    color: #cc6600 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    padding: 10px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
}

.template4 .scrollable-value-area .t4-column-header {
    background: linear-gradient(135deg, #e6f7ff 0%, #ccf0ff 100%) !important;
    border: 1px solid #66ccff !important;
    color: #0099cc !important;
    font-weight: 600 !important;
    text-align: center !important;
    padding: 8px 10px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
}

/* ---------- BODY CELL STYLING ---------- */
.template4 .frozen-row-dimensions .t4-dimension-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: top !important;
}

.template4 .scrollable-value-area .value-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
}

/* ---------- ROW SYNCHRONIZATION ---------- */
.template4 .frozen-row-dimensions tbody tr,
.template4 .scrollable-value-area tbody tr {
    height: 40px !important; /* ADDED: fixed height for alignment */
    min-height: 40px !important;
    max-height: 40px !important;
    box-sizing: border-box !important;
}

.template4 .frozen-row-dimensions thead tr,
.template4 .scrollable-value-area thead tr {
    height: 45px !important; /* ADDED: consistent header height */
    min-height: 45px !important;
    max-height: 45px !important;
    box-sizing: border-box !important;
}

.template4 .frozen-row-dimensions th,
.template4 .frozen-row-dimensions td,
.template4 .scrollable-value-area th,
.template4 .scrollable-value-area td {
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    line-height: 1.2 !important;
    overflow: hidden !important;
}

/* ---------- ENHANCED SCROLLBARS FOR VALUE AREA ---------- */
.template4 .scrollable-value-area::-webkit-scrollbar {
    width: 12px !important;
    height: 12px !important;
}

.template4 .scrollable-value-area::-webkit-scrollbar-track {
    background: #f8f9fa !important;
    border-radius: 6px !important;
}

.template4 .scrollable-value-area::-webkit-scrollbar-thumb {
    background: #cbd5e1 !important;
    border-radius: 6px !important;
    border: 2px solid #f8f9fa !important;
}

.template4 .scrollable-value-area::-webkit-scrollbar-thumb:hover {
    background: #94a3b8 !important;
}

.template4 .scrollable-value-area::-webkit-scrollbar-corner {
    background: #f8f9fa !important;
}

/* ---------- HIERARCHY STYLING ---------- */
.template4 .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    vertical-align: middle !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    cursor: pointer !important;
    font-size: 10px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    flex-shrink: 0 !important;
}

.template4 .leaf-node-empty {
    display: inline-block !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
}

.template4 .dimension-label {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: clip !important;
    max-width: calc(100% - 25px) !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.3 !important;
}

.template4 .column-label {
    display: inline-block !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    max-width: none !important;
    width: auto !important;
    font-weight: inherit !important;
    color: inherit !important;
}

.template4 .frozen-separator {
    position: absolute !important;
    top: 0 !important;
    left: 45% !important;
    width: 1px !important; /* CHANGED: was 3px */
    height: 100% !important;
    background: #6c757d !important; /* CHANGED: was gradient, now solid grey */
    z-index: 200 !important;
    cursor: col-resize !important;
    box-shadow: none !important; /* REMOVED: was shadow */
}

.template4 .frozen-separator:hover {
    background: #495057 !important; /* CHANGED: darker grey instead of gradient */
    width: 1px !important; /* CHANGED: keep 1px instead of expanding */
    left: 45% !important; /* CHANGED: no position shift */
}

/* ---------- RESPONSIVE ADJUSTMENTS ---------- */
@media (max-width: 1400px) {
    .template4 .frozen-row-dimensions {
        width: 40% !important;
    }
    
    .template4 .scrollable-value-area {
        left: 40% !important;
        width: 60% !important;
    }
    
    .template4 .frozen-separator {
        left: 40% !important;
    }
}

@media (max-width: 1024px) {
    .template4 .frozen-row-dimensions {
        width: 35% !important;
    }
    
    .template4 .scrollable-value-area {
        left: 35% !important;
        width: 65% !important;
    }
    
    .template4 .frozen-separator {
        left: 35% !important;
    }
    
    .template4 th,
    .template4 td {
        padding: 6px 8px !important;
        font-size: 0.8rem !important;
    }
}

@media (max-width: 768px) {
    .template4 {
        height: 60vh !important;
    }
    
    .template4 th,
    .template4 td {
        padding: 4px 6px !important;
        font-size: 0.75rem !important;
    }
}

@media (max-height: 800px) {
    .template4 {
        max-height: 35vh !important;
    }
}

@media (max-height: 600px) {
    .template4 {
        max-height: 50vh !important;
    }
}

/* ---------- HOVER EFFECTS ---------- */
.template4 .frozen-row-dimensions tr:hover .t4-dimension-cell {
    background-color: rgba(102, 153, 255, 0.08) !important;
}

.template4 .scrollable-value-area tr:hover .value-cell {
    background-color: rgba(102, 153, 255, 0.05) !important;
}

/* ---------- VALUE CELL ENHANCEMENTS ---------- */
.template4 .value-cell.non-zero-value {
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffe6 100%) !important;
    color: #006600 !important;
    font-weight: 600 !important;
}

.template4 .value-cell.large-value {
    background: linear-gradient(135deg, #fff8dc 0%, #f0e68c 100%) !important;
    color: #b8860b !important;
    font-weight: 700 !important;
}

.template4 .value-cell[data-raw-value^="-"] {
    color: #dc2626 !important;
    font-weight: 700 !important;
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
}

/* Template 4 Enhanced Header Alignment */
.template4 .frozen-row-dimensions .t4-row-header[rowspan] {
    vertical-align: middle !important;
    text-align: center !important;
    padding: 12px 8px !important;
    line-height: 1.2 !important;
    height: auto !important;
    border-right: 2px solid #6699ff !important;
}

/* Ensure header heights match between frozen and scrollable areas */
.template4 .frozen-row-dimensions thead,
.template4 .scrollable-value-area thead {
    height: auto !important;
}

.template4 .frozen-row-dimensions thead tr,
.template4 .scrollable-value-area thead tr {
    height: 45px !important;
    min-height: 45px !important;
}

/* Prevent header row height conflicts */
.template4 .frozen-row-dimensions .t4-row-header {
    box-sizing: border-box !important;
    display: table-cell !important;
    vertical-align: middle !important;
}

/* CRITICAL FIX: Ensure Template 4 headers span exactly 3 rows */
.template4 .frozen-row-dimensions .t4-row-header[rowspan="3"] {
    vertical-align: middle !important;
    text-align: center !important;
    padding: 12px 8px !important;
    line-height: 1.2 !important;
    height: auto !important;
    border-right: 2px solid #6699ff !important;
    background: linear-gradient(135deg, #f0f8ff 0%, #ddeeff 100%) !important;
    border: 1px solid #6699ff !important;
    color: #003399 !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
}

/* Ensure proper header row heights for alignment */
.template4 .frozen-row-dimensions thead tr {
    height: 45px !important;
    min-height: 45px !important;
    max-height: 45px !important;
}

.template4 .scrollable-value-area thead tr {
    height: 45px !important;
    min-height: 45px !important;
    max-height: 45px !important;
}

/* Fix the CSS syntax error */
.template4 .frozen-row-dimensions tbody tr,
.template4 .scrollable-value-area tbody tr {
    height: 40px !important;
    min-height: 40px !important;
    max-height: 40px !important;
    box-sizing: border-box !important; /* FIXED: removed invalid "/" */
}

/* Ensure both areas have consistent table structure */
.template4 .frozen-row-dimensions table,
.template4 .scrollable-value-area table {
    border-collapse: separate !important;
    border-spacing: 0 !important;
}

/* Enhanced frozen separator visibility */
.template4 .frozen-separator {
    position: absolute !important;
    top: 0 !important;
    left: 45% !important;
    width: 1px !important;
    height: 100% !important;
    background: #6c757d !important;
    z-index: 200 !important;
    pointer-events: none !important;
}

/* Prevent any header content overflow */
.template4 .t4-row-header .header-content {
    width: 100% !important;
    height: auto !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

/* ---------- TEMPLATE 5: 2+ rows + 2+ columns + values ---------- */
/* ===========================================
   TEMPLATE 5 FIXES - Excel-like Frozen Panes System
   Multi-row × Multi-column with 45:55 split and frozen boundaries
   =========================================== */

/* ---------- CONTAINER SETUP FOR EXCEL-LIKE FROZEN PANES ---------- */
.template5 {
    width: 100% !important;
    height: auto !important;
    max-height: 40vh !important;
    min-height: 300px !important;
    position: relative !important;
    overflow: hidden !important;
    border: 1px solid #e5e7eb !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
}

.template5 .pivot-table-container {
    width: 100% !important;
    height: 100% !important;
    position: relative !important;
    overflow: hidden !important;
    background: white !important;
}

/* ---------- FROZEN ROW DIMENSIONS AREA (45% LEFT SIDE) ---------- */
.template5 .frozen-row-dimensions {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 45% !important;
    height: 100% !important;
    background: white !important;
    border-right: 1px solid #6c757d !important;
    z-index: 100 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* ---------- SCROLLABLE VALUE AREA (55% RIGHT SIDE) ---------- */
.template5 .scrollable-value-area {
    position: absolute !important;
    top: 0 !important;
    left: 45% !important;
    width: 55% !important;
    height: 100% !important;
    overflow: auto !important;
    background: white !important;
    z-index: 50 !important;
}

/* ---------- FROZEN SEPARATOR (1PX GREY LINE) ---------- */
.template5 .frozen-separator {
    position: absolute !important;
    top: 0 !important;
    left: 45% !important;
    width: 1px !important;
    height: 100% !important;
    background: #6c757d !important;
    z-index: 200 !important;
    cursor: col-resize !important;
    pointer-events: none !important;
}

/* ---------- TABLE LAYOUT FOR BOTH AREAS ---------- */
.template5 .frozen-row-dimensions table,
.template5 .scrollable-value-area table {
    width: 100% !important;
    table-layout: fixed !important;
    border-collapse: separate !important;
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* Values area table should expand based on content */
.template5 .scrollable-value-area table {
    width: max-content !important;
    min-width: 100% !important;
    table-layout: auto !important;
}

/* ---------- ROW DIMENSION EQUAL WIDTH DISTRIBUTION (45% SPLIT) ---------- */
/* 2 Row Dimensions */
.template5.row-dimensions-2 .frozen-row-dimensions .t5-row-header,
.template5.row-dimensions-2 .frozen-row-dimensions .t5-dimension-cell {
    width: 50% !important;
    min-width: 50% !important;
    max-width: 50% !important;
}

/* 3 Row Dimensions */
.template5.row-dimensions-3 .frozen-row-dimensions .t5-row-header,
.template5.row-dimensions-3 .frozen-row-dimensions .t5-dimension-cell {
    width: 33.333% !important;
    min-width: 33.333% !important;
    max-width: 33.333% !important;
}

/* 4 Row Dimensions */
.template5.row-dimensions-4 .frozen-row-dimensions .t5-row-header,
.template5.row-dimensions-4 .frozen-row-dimensions .t5-dimension-cell {
    width: 25% !important;
    min-width: 25% !important;
    max-width: 25% !important;
}

/* 5 Row Dimensions */
.template5.row-dimensions-5 .frozen-row-dimensions .t5-row-header,
.template5.row-dimensions-5 .frozen-row-dimensions .t5-dimension-cell {
    width: 20% !important;
    min-width: 20% !important;
    max-width: 20% !important;
}

/* ---------- VALUE AREA DYNAMIC WIDTH (55% AREA, AUTO COLUMNS) ---------- */
.template5 .scrollable-value-area .t5-measures-header,
.template5 .scrollable-value-area .t5-measure-header,
.template5 .scrollable-value-area .t5-column-header,
.template5 .scrollable-value-area .value-cell {
    width: auto !important;
    min-width: 80px !important;
    max-width: none !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
}

/* ---------- CONSISTENT ROW HEIGHTS FOR ALIGNMENT ---------- */
.template5 .frozen-row-dimensions tbody tr,
.template5 .scrollable-value-area tbody tr {
    height: 40px !important;
    min-height: 40px !important;
    max-height: 40px !important;
    box-sizing: border-box !important;
}

.template5 .frozen-row-dimensions thead tr,
.template5 .scrollable-value-area thead tr {
    height: 45px !important;
    min-height: 45px !important;
    max-height: 45px !important;
    box-sizing: border-box !important;
}

/* ---------- HEADER STYLING FOR FROZEN AREA ---------- */
.template5 .frozen-row-dimensions .t5-row-header {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%) !important;
    border: 1px solid #3b82f6 !important;
    color: #1e40af !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 12px 8px !important;
    box-sizing: border-box !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 25 !important;
    vertical-align: middle !important;
}

/* ---------- HEADER STYLING FOR SCROLLABLE AREA ---------- */
.template5 .scrollable-value-area .t5-measures-header {
    background: linear-gradient(135deg, #f8f0ff 0%, #e6ccff 100%) !important;
    border: 2px solid #9966cc !important;
    color: #663399 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
}

.template5 .scrollable-value-area .t5-measure-header {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe0b3 100%) !important;
    border: 1px solid #ff9933 !important;
    color: #cc6600 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    padding: 10px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
}

.template5 .scrollable-value-area .t5-column-header {
    background: linear-gradient(135deg, #f0fff4 0%, #dcfce7 100%) !important;
    border: 1px solid #22c55e !important;
    color: #15803d !important;
    font-weight: 600 !important;
    text-align: center !important;
    padding: 8px 10px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 80px !important;
}

/* ---------- BODY CELL STYLING ---------- */
.template5 .frozen-row-dimensions .t5-dimension-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    padding: 8px 12px !important;
    box-sizing: border-box !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
    vertical-align: middle !important;
    line-height: 1.2 !important;
}

.template5 .scrollable-value-area .value-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    min-width: 80px !important;
}

/* ---------- HIERARCHY CONTROLS ---------- */
.template5 .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    vertical-align: middle !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    cursor: pointer !important;
    font-size: 10px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    flex-shrink: 0 !important;
}

.template5 .leaf-node-empty {
    display: inline-block !important;
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
}

.template5 .dimension-label {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: clip !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.3 !important;
}

.template5 .column-label {
    display: inline-block !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    font-weight: inherit !important;
    color: inherit !important;
}

/* ---------- ENHANCED SCROLLBARS ---------- */
.template5 .frozen-row-dimensions::-webkit-scrollbar {
    width: 6px !important;
    background: transparent !important;
}

.template5 .frozen-row-dimensions::-webkit-scrollbar-track {
    background: #f8f9fa !important;
}

.template5 .frozen-row-dimensions::-webkit-scrollbar-thumb {
    background: #cbd5e1 !important;
    border-radius: 3px !important;
}

.template5 .scrollable-value-area::-webkit-scrollbar {
    width: 8px !important;
    height: 8px !important;
}

.template5 .scrollable-value-area::-webkit-scrollbar-track {
    background: #f8f9fa !important;
    border-radius: 4px !important;
}

.template5 .scrollable-value-area::-webkit-scrollbar-thumb {
    background: #cbd5e1 !important;
    border-radius: 4px !important;
    border: 1px solid #f8f9fa !important;
}

.template5 .scrollable-value-area::-webkit-scrollbar-thumb:hover {
    background: #94a3b8 !important;
}

.template5 .scrollable-value-area::-webkit-scrollbar-corner {
    background: #f8f9fa !important;
}

/* ---------- HOVER EFFECTS ---------- */
.template5 .frozen-row-dimensions tr:hover .t5-dimension-cell {
    background-color: rgba(59, 130, 246, 0.05) !important;
}

.template5 .scrollable-value-area tr:hover .value-cell {
    background-color: rgba(59, 130, 246, 0.05) !important;
}

/* ---------- VALUE CELL ENHANCEMENTS ---------- */
.template5 .value-cell.non-zero-value {
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffe6 100%) !important;
    color: #006600 !important;
    font-weight: 600 !important;
}

.template5 .value-cell.large-value {
    background: linear-gradient(135deg, #fff8dc 0%, #f0e68c 100%) !important;
    color: #b8860b !important;
    font-weight: 700 !important;
}

.template5 .value-cell[data-raw-value^="-"] {
    color: #dc2626 !important;
    font-weight: 700 !important;
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
}

/* ---------- RESPONSIVE ADJUSTMENTS ---------- */
@media (max-width: 1400px) {
    .template5 .frozen-row-dimensions {
        width: 40% !important;
    }
    
    .template5 .scrollable-value-area {
        left: 40% !important;
        width: 60% !important;
    }
    
    .template5 .frozen-separator {
        left: 40% !important;
    }
}

@media (max-width: 1024px) {
    .template5 .frozen-row-dimensions {
        width: 35% !important;
    }
    
    .template5 .scrollable-value-area {
        left: 35% !important;
        width: 65% !important;
    }
    
    .template5 .frozen-separator {
        left: 35% !important;
    }
}

@media (max-height: 800px) {
    .template5 {
        max-height: 35vh !important;
    }
}

@media (max-height: 600px) {
    .template5 {
        max-height: 50vh !important;
    }
}

/* ---------- CELL CONTENT WRAPPER FOR ALIGNMENT ---------- */
.template5 .cell-content {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: flex-start !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
}

.template5 .value-cell .cell-content {
    justify-content: flex-end !important;
}

/* ---------- DEBUG HELPERS (REMOVE IN PRODUCTION) ---------- */
.template5.debug .frozen-row-dimensions {
    background: rgba(255, 0, 0, 0.1) !important;
    border: 2px solid red !important;
}

.template5.debug .scrollable-value-area {
    background: rgba(0, 0, 255, 0.1) !important;
    border: 2px solid blue !important;
}

.template5.debug .frozen-separator {
    background: lime !important;
    width: 3px !important;
}

/* ===========================================
   ENHANCED TEMPLATE 6 CSS - HIERARCHICAL MULTI-COLUMN
   1 row + 2+ columns + values with Excel-like column spanning
   =========================================== */


/* ---------- CONTAINER AND TABLE LAYOUT ---------- */
.template6 {
    width: 100% !important;
    height: auto !important;
    max-height: 60vh !important;
    min-height: 250px !important;
    overflow: auto !important;
    border: 1px solid #e5e7eb !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
}

.template6 .pivot-table-container {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    background: white !important;
}

.template6 table {
    width: 100% !important;
    table-layout: auto !important;
    border-collapse: separate !important;
    border-spacing: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    min-width: fit-content !important;
}

/* ---------- ROW DIMENSION HEADER (STICKY LEFT) ---------- */
.template6 .t6-row-header {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
    border: 2px solid #d97706 !important;
    color: #92400e !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 15px 12px !important;
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 60 !important;
    min-width: 500px !important;
    max-width: 650px !important;
    width: 500px !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
}

/* ---------- MEASURES HEADER ---------- */
.template6 .t6-measures-header {
    background: linear-gradient(135deg, #f8f0ff 0%, #e6ccff 100%) !important;
    border: 2px solid #9966cc !important;
    color: #663399 !important;
    font-weight: 700 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1.5px !important;
    padding: 12px 15px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    box-sizing: border-box !important;
}

/* ---------- VALUE FIELD HEADERS ---------- */
.template6 .t6-measure-header {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe0b3 100%) !important;
    border: 1px solid #ff9933 !important;
    color: #cc6600 !important;
    font-weight: 600 !important;
    text-align: center !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    padding: 10px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 100px !important;
    box-sizing: border-box !important;
}

/* ---------- HIERARCHICAL COLUMN HEADERS WITH SPANNING ---------- */
.template6 .t6-column-header {
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important;
    border: 1px solid #22c55e !important;
    color: #15803d !important;
    font-weight: 600 !important;
    text-align: center !important;
    padding: 8px 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 15 !important;
    min-width: 80px !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    white-space: nowrap !important;
}

/* Different styling for different dimension levels */
.template6 .t6-column-header.dimension-level-0 {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%) !important;
    border: 2px solid #3b82f6 !important;
    color: #1e40af !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
    letter-spacing: 0.5px !important;
    padding: 10px 12px !important;
}

.template6 .t6-column-header.dimension-level-1 {
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%) !important;
    border: 1px solid #16a34a !important;
    color: #166534 !important;
    font-weight: 600 !important;
    font-size: 0.85rem !important;
    padding: 8px 10px !important;
}

.template6 .t6-column-header.dimension-level-2 {
    background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%) !important;
    border: 1px solid #eab308 !important;
    color: #a16207 !important;
    font-weight: 600 !important;
    font-size: 0.8rem !important;
    padding: 6px 8px !important;
}

/* ---------- ROW HIERARCHY CELL (STICKY LEFT) ---------- */
.template6 .t6-hierarchy-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    border-right: 2px solid #d97706 !important;
    padding: 8px 12px !important;
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    min-width: 180px !important;
    max-width: 250px !important;
    width: 200px !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: normal !important;
}

/* ---------- VALUE CELLS ---------- */
.template6 .t6-value-cell {
    background: white !important;
    border: 1px solid #e5e7eb !important;
    text-align: right !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    box-sizing: border-box !important;
    vertical-align: middle !important;
    min-width: 80px !important;
    white-space: nowrap !important;
}

/* Enhanced value cell styling */
.template6 .t6-value-cell.non-zero-value {
    background: linear-gradient(135deg, #f0fff4 0%, #e6ffe6 100%) !important;
    color: #15803d !important;
    font-weight: 600 !important;
}

.template6 .t6-value-cell.large-value {
    background: linear-gradient(135deg, #fff8dc 0%, #f0e68c 100%) !important;
    color: #b8860b !important;
    font-weight: 700 !important;
}

.template6 .t6-value-cell.negative-value {
    color: #dc2626 !important;
    font-weight: 700 !important;
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
}

/* ---------- ENHANCED EXPAND/COLLAPSE CONTROLS - IMPROVEMENTS 2 & 3 ---------- */
.template6 .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    vertical-align: middle !important;
    border: 1px solid #6c757d !important;
    border-radius: 3px !important;
    background: white !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    flex-shrink: 0 !important;
}

.template6 .expand-collapse.collapsed {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
    border-color: #d97706 !important;
    color: #92400e !important;
}

.template6 .expand-collapse.collapsed::before {
    content: "+" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 14px !important;
    font-weight: bold !important;
}

.template6 .expand-collapse.expanded {
    background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%) !important;
    border-color: #16a34a !important;
    color: #15803d !important;
}

.template6 .expand-collapse.expanded::before {
    content: "−" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 16px !important;
    font-weight: bold !important;
}

.template6 .expand-collapse:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
}

/* IMPROVEMENT 3: Remove leaf node styling from column headers - only in column zone */
.template6 .t6-column-header .leaf-node-empty {
    display: none !important;
}

/* Keep leaf node styling only for row hierarchy cells */
.template6 .t6-hierarchy-cell .leaf-node-empty {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    border: 1px solid #6c757d !important;
    border-radius: 3px !important;
    background: white !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
    box-sizing: border-box !important;
}

/* ---------- DIMENSION AND COLUMN LABELS ---------- */
.template6 .dimension-label {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: clip !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    line-height: 1.3 !important;
    max-width: calc(100% - 30px) !important;
}

.template6 .column-label {
    display: inline-block !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    font-weight: inherit !important;
    color: inherit !important;
    max-width: none !important;
}

/* ---------- CELL CONTENT WRAPPER ---------- */
.template6 .cell-content {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: flex-start !important;
    overflow: visible !important;
    text-overflow: clip !important;
    white-space: nowrap !important;
}

.template6 .t6-value-cell .cell-content {
    justify-content: flex-end !important;
}

.template6 .t6-column-header .cell-content,
.template6 .t6-measure-header .cell-content,
.template6 .t6-measures-header .cell-content {
    justify-content: center !important;
}

/* ---------- STICKY POSITIONING ---------- */
.template6 thead th {
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important;
    background-clip: padding-box !important;
}

/* Ensure row header stays on top of everything */
.template6 .t6-row-header {
    z-index: 60 !important;
}

/* Ensure hierarchy cells stay sticky */
.template6 .t6-hierarchy-cell {
    z-index: 20 !important;
}

/* ---------- HOVER EFFECTS ---------- */
.template6 tbody tr:hover {
    background-color: rgba(251, 191, 36, 0.05) !important;
}

.template6 tbody tr:hover .t6-hierarchy-cell {
    background-color: rgba(251, 191, 36, 0.08) !important;
}

.template6 tbody tr:hover .t6-value-cell {
    background-color: rgba(251, 191, 36, 0.03) !important;
}

.template6 .t6-column-header:hover {
    background-color: rgba(34, 197, 94, 0.15) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
}

/* ---------- VISUAL HIERARCHY FOR ROW LEVELS ---------- */
.template6 [data-level="0"] {
    font-weight: 700 !important;
    background-color: #fffbeb !important;
}

.template6 [data-level="1"] {
    font-weight: 600 !important;
    padding-left: 20px !important;
}

.template6 [data-level="2"] {
    font-weight: 500 !important;
    padding-left: 32px !important;
}

.template6 [data-level="3"] {
    font-weight: 400 !important;
    padding-left: 44px !important;
}

.template6 [data-level="4"] {
    font-weight: 400 !important;
    padding-left: 56px !important;
    font-size: 0.9rem !important;
}

/* ---------- RESPONSIVE ADJUSTMENTS ---------- */
@media (max-width: 1400px) {
    .template6 .t6-row-header,
    .template6 .t6-hierarchy-cell {
        min-width: 35% !important;
        max-width: 40% !important;
    }
    
    .template6 .t6-column-header,
    .template6 .t6-value-cell {
        min-width: 70px !important;
        padding: 6px 8px !important;
    }
}

@media (max-width: 1024px) {
    .template6 {
        max-height: 50vh !important;
    }
    
    .template6 .t6-row-header,
    .template6 .t6-hierarchy-cell {
        min-width: 35% !important;
        max-width: 40% !important;
        font-size: 0.85rem !important;
    }
    
    .template6 .t6-column-header,
    .template6 .t6-value-cell {
        min-width: 60px !important;
        padding: 4px 6px !important;
        font-size: 0.8rem !important;
    }
    
    .template6 .expand-collapse,
    .template6 .leaf-node-empty {
        width: 14px !important;
        height: 14px !important;
        margin-right: 6px !important;
        font-size: 10px !important;
    }
}

@media (max-width: 768px) {
    .template6 {
        max-height: 40vh !important;
    }
    
    .template6 .t6-row-header,
    .template6 .t6-hierarchy-cell {
        min-width: 35% !important;
        max-width: 40% !important;
        font-size: 0.8rem !important;
    }
    
    .template6 .t6-column-header,
    .template6 .t6-value-cell {
        min-width: 50px !important;
        padding: 3px 4px !important;
        font-size: 0.75rem !important;
    }
    
    .template6 .expand-collapse,
    .template6 .leaf-node-empty {
        width: 12px !important;
        height: 12px !important;
        margin-right: 4px !important;
        font-size: 8px !important;
    }
}

/* ---------- PRINT STYLES ---------- */
@media print {
    .template6 {
        max-height: none !important;
        overflow: visible !important;
        box-shadow: none !important;
        border: 1px solid #000 !important;
    }
    
    .template6 .expand-collapse {
        display: none !important;
    }
    
    .template6 .leaf-node-empty {
        display: none !important;
    }
}

/* ---------- ACCESSIBILITY ENHANCEMENTS ---------- */
.template6 .expand-collapse:focus {
    outline: 2px solid #3b82f6 !important;
    outline-offset: 2px !important;
}

.template6 .t6-column-header:focus-within {
    outline: 2px solid #22c55e !important;
    outline-offset: 1px !important;
}

/* ---------- HIGH CONTRAST MODE ---------- */
@media (prefers-contrast: high) {
    .template6 .t6-row-header {
        background: #000 !important;
        color: #fff !important;
        border: 2px solid #fff !important;
    }
    
    .template6 .t6-column-header {
        background: #fff !important;
        color: #000 !important;
        border: 2px solid #000 !important;
    }
    
    .template6 .t6-value-cell {
        background: #fff !important;
        color: #000 !important;
        border: 1px solid #000 !important;
    }
}

/* ---------- ANIMATION FOR EXPAND/COLLAPSE ---------- */
@keyframes expandCollapse {
    0% { transform: scale(1) rotate(0deg); }
    50% { transform: scale(1.2) rotate(180deg); }
    100% { transform: scale(1) rotate(360deg); }
}

.template6 .expand-collapse.animating {
    animation: expandCollapse 0.3s ease-in-out !important;
}

/* ---------- SPANNING HEADER VISUAL SEPARATION ---------- */
.template6 .t6-column-header[colspan] {
    position: relative !important;
}

.template6 .t6-column-header[colspan]::after {
    content: "" !important;
    position: absolute !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 2px !important;
    background: linear-gradient(90deg, transparent 0%, currentColor 50%, transparent 100%) !important;
    opacity: 0.3 !important;
}

/* ---------- OPTIMIZED TABLE RENDERING ---------- */
.template6 table {
    will-change: scroll-position !important;
    contain: layout !important;
}

.template6 .t6-value-cell {
    contain: paint !important;
}

/* ---------- SCROLLBAR STYLING ---------- */
.template6::-webkit-scrollbar {
    width: 10px !important;
    height: 10px !important;
}

.template6::-webkit-scrollbar-track {
    background: #f8f9fa !important;
    border-radius: 5px !important;
}

.template6::-webkit-scrollbar-thumb {
    background: #d97706 !important;
    border-radius: 5px !important;
    border: 2px solid #f8f9fa !important;
}

.template6::-webkit-scrollbar-thumb:hover {
    background: #b45309 !important;
}

.template6::-webkit-scrollbar-corner {
    background: #f8f9fa !important;
}


/* ---------- UNIVERSAL FIXES FOR ALL TEMPLATES ---------- */
/* Apply the original fixes to all templates */

/* FIX 1: Hide VALUE columns in all templates */
[class*="template"] th[data-material-type="VALUE"],
[class*="template"] th[data-measure="VALUE"],
[class*="template"] .column-header[data-material-type="VALUE"],
[class*="template"] td[data-raw-value="VALUE"] {
    display: none !important;
}

/* FIX 2: Remove leaf node dots from column headers in all templates */
[class*="template"] .column-header .leaf-node,
[class*="template"] thead .leaf-node {
    display: none !important;
}

[class*="template"] .column-header .leaf-node::after,
[class*="template"] .column-header .leaf-node::before {
    display: none !important;
    content: none !important;
}

/* FIX 3: Ensure full labels are displayed in all templates */
[class*="template"] .dimension-label {
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    max-width: none !important;
    display: inline-block !important;
    vertical-align: middle !important;
    word-wrap: normal !important;
    overflow-wrap: normal !important;
    line-height: 1.4 !important;
}

/* FIX 4: Empty leaf nodes for all templates */
[class*="template"] .leaf-node-empty {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    vertical-align: middle !important;
    flex-shrink: 0 !important;
    box-sizing: border-box !important;
}

/* Remove dots from leaf nodes in all templates */
[class*="template"] .leaf-node::after,
[class*="template"] .leaf-node::before {
    display: none !important;
    content: none !important;
}

/* Enhanced expand/collapse controls for all templates */
[class*="template"] .expand-collapse {
    display: inline-flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: 16px !important;
    height: 16px !important;
    margin-right: 8px !important;
    vertical-align: middle !important;
    border: 1px solid #6c757d !important;
    border-radius: 2px !important;
    background: white !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: bold !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    flex-shrink: 0 !important;
}

[class*="template"] .expand-collapse.collapsed {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
    border-color: #d97706 !important;
    color: #92400e !important;
}

[class*="template"] .expand-collapse.collapsed::before {
    content: "+" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 14px !important;
    font-weight: bold !important;
}

[class*="template"] .expand-collapse.expanded {
    background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%) !important;
    border-color: #16a34a !important;
    color: #15803d !important;
}

[class*="template"] .expand-collapse.expanded::before {
    content: "−" !important;
    display: block !important;
    line-height: 1 !important;
    font-size: 16px !important;
    font-weight: bold !important;
}

/* Value cells consistent across all templates */
[class*="template"] .value-cell {
    text-align: right !important;
    font-family: var(--font-sans, system-ui) !important;
    background-color: white !important;
    padding: 8px 12px !important;
    font-variant-numeric: tabular-nums !important;
    font-weight: 500 !important;
    transition: background-color 0.2s ease !important;
    min-width: fit-content !important;
    width: auto !important;
    border: 1px solid #e5e7eb !important;
}

/* Enhanced value cell styling for non-zero values */
[class*="template"] .value-cell.non-zero-value {
    background: #f0fdf4 !important;
    color: #15803d !important;
    font-weight: 600 !important;
}

/* Negative values styling */
[class*="template"] .value-cell[data-raw-value^="-"] {
    color: #dc2626 !important;
    font-weight: 700 !important;
    background-color: white !important;
}

/* Responsive adjustments for all templates */
@media (max-width: 1200px) {
    [class*="template"] .leaf-node-empty,
    [class*="template"] .expand-collapse {
        width: 14px !important;
        height: 14px !important;
        margin-right: 6px !important;
        font-size: 10px !important;
    }
    
    [class*="template"] th,
    [class*="template"] td {
        padding: 6px 8px !important;
        font-size: 0.8rem !important;
    }
}

@media (max-width: 768px) {
    [class*="template"] .leaf-node-empty,
    [class*="template"] .expand-collapse {
        width: 12px !important;
        height: 12px !important;
        margin-right: 4px !important;
        font-size: 8px !important;
    }
    
    [class*="template"] th,
    [class*="template"] td {
        padding: 4px 6px !important;
        font-size: 0.75rem !important;
    }
}

/* Sticky headers for all templates */
[class*="template"] thead th {
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important;
    background-clip: padding-box !important;
}

/* Sticky first column for all templates */
[class*="template"] [class*="hierarchy-cell"],
[class*="template"] [class*="dimension-cell"]:first-child {
    position: sticky !important;
    left: 0 !important;
    z-index: 20 !important;
    background: white !important;
}

/* Corner cells for all templates */
[class*="template"] .corner-cell,
[class*="template"] [class*="row-header"][rowspan] {
    position: sticky !important;
    left: 0 !important;
    top: 0 !important;
    z-index: 50 !important;
    text-align: center !important;
    vertical-align: middle !important;
}